name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Install CapRover CLI
        run: npm install -g caprover

      - name: Test CapRover Connection
        run: |
          echo "Testing connection to CapRover..."
          echo "URL: ${{ secrets.CAPROVER_URL }}"
          # No imprimas la contrase√±a real en los logs
          echo "App name: ${{ secrets.CAPROVER_APP_NAME }}"

      - name: Deploy to CapRover
        run: |
          caprover deploy \
            --caproverUrl "${{ secrets.CAPROVER_URL }}" \
            --caproverPassword "${{ secrets.CAPROVER_PASSWORD }}" \
            --appName "${{ secrets.CAPROVER_APP_NAME }}" \
            --branch main
